import{c as b}from"./loader-BNZq2rkl.js";/* empty css                    */import"./session--oNH02Qd.js";const v="https://opzechnwukuqfvfaytfx.supabase.co",y="sb_publishable_w87ezT-fcldEAO653BOpwQ_UvJtX51_",s=b(v,y);let l;const g=document.getElementById("good-notification"),p=document.getElementById("fail-notification");function _(){g.classList.remove("hidden"),l&&(p.classList.add("hidden"),clearTimeout(l)),l=setTimeout(()=>{g.classList.add("hidden")},2e3)}function c(){p.classList.remove("hidden"),l&&(g.classList.add("hidden"),clearTimeout(l)),l=setTimeout(()=>{p.classList.add("hidden")},2e3)}async function E(i=null){const{data:{user:t}}=await s.auth.getUser(),e=document.getElementById("product-grid");let r,d;if(!e)return;if(i)r=i;else{const{data:n,error:a}=await s.from("products").select("*");r=n||[],d=a}if(e.innerHTML="",r.length===0){e.innerHTML="<p>No products found matching that search.</p>";return}let o=[];if(t){const{data:n}=await s.from("wishlist").select("product_id").eq("user_id",t.id);o=n?n.map(a=>String(a.product_id)):[]}d?c(d.message):r.forEach(n=>{const a=document.createElement("div"),w=o.includes(String(n.id));a.innerHTML=`
      <div class="border border-gray-400 p-5 rounded-2xl dark:bg-[#191b1f] bg-gray-100/70 dark:border-0 transition-all duration-300" id="productbox">
      <div class="flex flex-row relative overflow-hidden rounded-2xl">
          <img src="${n.image_url[0]||n.image_url}" class="w-full md:h-64 h-50 object-cover hover:scale-102 transition-transform duration-300">
          <button class="wishlist-btn cursor-pointer absolute top-3 right-3 bg-white/30 backdrop-blur-sm p-2 rounded-full ${w?"text-red-500":"text-gray-400"} hover:text-red-500 transition-colors shadow-sm" data-id="${n.id}">
            <svg xmlns="http://www.w3.org/2000/svg" ${w?'fill="currentColor"':'fill="none"'} viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 pointer-events-none">
              <path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z" />
            </svg>
          </button>
      </div>

        <div class="mt-3">
          <p class="font-bold text-lg dark:text-white">${n.title}</p>
          <span class="font-bold text-lg text-green-600">₹${n.price}</span>
        </div></div>`,e.appendChild(a)})}E();const x=document.getElementById("product-grid"),m=document.getElementById("popupwindow"),L=document.getElementById("productdetails");let h;x.addEventListener("click",async i=>{if(i.target.tagName==="IMG"){console.log(i.target),document.getElementById("productpageuploadimage").src=i.target.src,m.classList.remove("hidden");const{data:t,error:e}=await s.from("products").select("*").contains("image_url",[i.target.src]).single();document.getElementById("productname").textContent=t.title,document.getElementById("productprice").textContent="₹"+t.price,h=t.title,document.getElementById("productdescription").textContent=t.description}});document.getElementById("contactsellerbutton").addEventListener("click",async i=>{const{data:t,error:e}=await s.from("profiles").select("phone").eq("email","25b1161.allen@gectcr.ac.in").single(),r=t.phone;var d="Intrested in buying this product!",o="https://api.whatsapp.com/send?phone="+r+"&text="+encodeURIComponent(d);window.open(o,"_blank")});m.addEventListener("click",()=>{m.classList.add("hidden")});document.addEventListener("keydown",i=>{i.key==="Escape"&&m.classList.add("hidden")});L.addEventListener("click",i=>{i.stopPropagation()});const f=document.getElementById("nextimgbtn"),I=document.getElementById("previousimgbtn");let u=0;f.addEventListener("click",async i=>{const{data:t,error:e}=await s.from("products").select("image_url").eq("title",h),r=t[0].image_url.length;r==1&&(f.disabled=!0),u<r-1&&u++,document.getElementById("productpageuploadimage").src=t[0].image_url[u]});I.addEventListener("click",async i=>{const{data:t,error:e}=await s.from("products").select("image_url").eq("title",h);t[0].image_url.length==1&&(f.disabled=!0),u>0&&u--,document.getElementById("productpageuploadimage").src=t[0].image_url[u]});function k(){document.getElementById("product-grid").addEventListener("click",async t=>{const e=t.target.closest(".wishlist-btn");if(!e)return;t.preventDefault(),t.stopPropagation();const{data:{user:r}}=await s.auth.getUser();if(!r){c();return}const d=e.dataset.id;console.log(d);const o=e.querySelector("svg"),{data:n}=await s.from("wishlist").select("*").eq("product_id",d).eq("user_id",r.id).maybeSingle();if(n){const{error:a}=await s.from("wishlist").delete().eq("product_id",d).eq("user_id",r.id);a?(console.error("Error removing from wishlist:",a),c()):(o.setAttribute("fill","none"),e.classList.remove("text-red-500"),e.classList.add("text-gray-400"),c())}else{const{error:a}=await s.from("wishlist").insert([{product_id:d,user_id:r.id}]);a?(console.error("Error adding to wishlist:",a),c()):(o.setAttribute("fill","currentColor"),e.classList.remove("text-gray-400"),e.classList.add("text-red-500"),_())}})}k();document.getElementById("productpageaddtowishlistbtn").addEventListener("click",async i=>{const{data:{user:t}}=await s.auth.getUser();if(!t){c();return}const{data:e,error:r}=await s.from("products").select("*").contains("image_url",[i.target.src]).single(),{data:d}=await s.from("wishlist").select("*").eq("product_id",e.id).eq("user_id",t.id).maybeSingle();if(d){const{error:o}=await s.from("wishlist").delete().eq("product_id",e.id).eq("user_id",t.id);o?(console.error("Error removing from wishlist:",o),c()):alert("already in wishlist")}else{const{error:o}=await s.from("wishlist").insert([{product_id:e.id,user_id:t.id}]);o?(console.error("Error adding to wishlist:",o),c()):alert("item added to wishlist")}});
