import"./loader-yIERnUXV.js";/* empty css                    */import{c as h}from"./supabaseClient-BnuRKQFQ.js";import"./session-DnhtpGy1.js";import"https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";const y="https://opzechnwukuqfvfaytfx.supabase.co",w="sb_publishable_w87ezT-fcldEAO653BOpwQ_UvJtX51_",a=h(y,w);let c;const p=document.getElementById("good-notification"),m=document.getElementById("fail-notification");function v(){p.classList.remove("hidden"),c&&(m.classList.add("hidden"),clearTimeout(c)),c=setTimeout(()=>{p.classList.add("hidden")},2e3)}function l(){m.classList.remove("hidden"),c&&(p.classList.add("hidden"),clearTimeout(c)),c=setTimeout(()=>{m.classList.add("hidden")},2e3)}async function b(e=null){const{data:{user:i}}=await a.auth.getUser(),t=document.getElementById("product-grid");let r,n;if(!t)return;if(e)r=e;else{const{data:o,error:s}=await a.from("products").select("*");r=o||[],n=s}if(t.innerHTML="",r.length===0){t.innerHTML="<p>No products found matching that search.</p>";return}let d=[];if(i){const{data:o}=await a.from("wishlist").select("product_id").eq("user_id",i.id);d=o?o.map(s=>String(s.product_id)):[]}n?l(n.message):r.forEach(o=>{const s=document.createElement("div"),g=d.includes(String(o.id));s.innerHTML=`
      <div class="border border-gray-300 dark:border-0 p-5 rounded-2xl dark:bg-[#191b1f] bg-gray-200 transition-all duration-100" id="productbox">
      <div class="flex flex-row relative overflow-hidden rounded-2xl">
          <img src="${o.image_url}" class="w-full md:h-64 h-50 object-cover hover:scale-102 transition-transform duration-300">
          <button class="wishlist-btn cursor-pointer absolute top-3 right-3 bg-white/30 backdrop-blur-sm p-2 rounded-full ${g?"text-red-500":"text-gray-400"} hover:text-red-500 transition-colors shadow-sm" data-id="${o.id}">
            <svg xmlns="http://www.w3.org/2000/svg" ${g?'fill="currentColor"':'fill="none"'} viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 pointer-events-none">
              <path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z" />
            </svg>
          </button>
      </div>

        <div class="mt-3">
          <p class="font-bold text-lg dark:text-white">${o.title}</p>
          <span class="font-bold text-lg text-green-600">₹${o.price}</span>
        </div></div>`,t.appendChild(s)})}b();const E=document.getElementById("product-grid"),u=document.getElementById("popupwindow"),x=document.getElementById("productdetails");E.addEventListener("click",async e=>{if(e.target.tagName==="IMG"){console.log(e.target),document.getElementById("productpageuploadimage").src=e.target.src,u.classList.remove("hidden");const{data:i,error:t}=await a.from("products").select("*").contains("image_url",[e.target.src]).single();document.getElementById("productname").textContent=i.title,document.getElementById("productprice").textContent="₹"+i.price,document.getElementById("productdescription").textContent=i.description}});document.getElementById("contactsellerbutton").addEventListener("click",async e=>{const{data:i,error:t}=await a.from("profiles").select("phone").eq("email","25b1161.allen@gectcr.ac.in").single(),r=i.phone;var n="Hi I am intrested in buying this project",d="https://api.whatsapp.com/send?phone="+r+"&text="+encodeURIComponent(n);window.open(d,"_blank")});u.addEventListener("click",()=>{u.classList.add("hidden")});document.addEventListener("keydown",e=>{e.key==="Escape"&&u.classList.add("hidden")});x.addEventListener("click",e=>{e.stopPropagation()});const f=document.getElementById("search_input");f.addEventListener("keydown",e=>{const i=document.getElementById("product-grid"),t=document.getElementById("noresultsfound"),r=f.value.toLowerCase();let n=0;e.key=="Enter"&&(e.preventDefault(),Array.from(i.children).forEach(d=>{const o=d.querySelector("p");if(!o)return;const s=o.innerText.toLowerCase();console.log(s),s.includes(r)?(d.style.display="block",n++):d.style.display="none",n==0?t.style.display="block":t.style.display="none"}))});function L(){document.getElementById("product-grid").addEventListener("click",async i=>{const t=i.target.closest(".wishlist-btn");if(!t)return;i.preventDefault(),i.stopPropagation();const{data:{user:r}}=await a.auth.getUser();if(!r){l();return}const n=t.dataset.id,d=t.querySelector("svg"),{data:o}=await a.from("wishlist").select("*").eq("product_id",n).eq("user_id",r.id).maybeSingle();if(o){const{error:s}=await a.from("wishlist").delete().eq("product_id",n).eq("user_id",r.id);s?(console.error("Error removing from wishlist:",s),l()):(d.setAttribute("fill","none"),t.classList.remove("text-red-500"),t.classList.add("text-gray-400"),l())}else{const{error:s}=await a.from("wishlist").insert([{product_id:n,user_id:r.id}]);s?(console.error("Error adding to wishlist:",s),l()):(d.setAttribute("fill","currentColor"),t.classList.remove("text-gray-400"),t.classList.add("text-red-500"),v())}})}L();
